language: java
jdk:
- openjdk11
script:
- "./gradlew build"
env:
  global:
  - OSSRH_JIRA_USERNAME=navikt
  - GPG_KEY_NAME=navikt
  - secure: dkOMSijI7Zbr7lb1G5mmRTiII9QQPq1PZs3hK7513uDapCiPx29/YuhVGCg2++fXVok6HZogR4i70L4v7HX3U12BYpyNaQ9WNVvhWOnhn1RjT7ZM8MiD35XvlJxIU/R+i5BjDK9vwy4mXGm/4ipE/ZmAcp1mN8UGhMfjyQJueMKaeHhaaFub6gac60S0aE6Et7VjaMhTcmf8szXfS31m7GkKAaIWqH6hzwj23CYiI+bYx4FtnQyC41hEVBJgd0ev2FXZxyaTu5SsNl6mCJV+ucaJ/OtIKEr0kayR2ynF/skLr0FQnLvWPpOQSNduHpQx2lvzMHCjnkoFDUsj9ILkqEsHwEg4HUhTV2zRRqISZYrmGuD7BS2qry8KSiCqsxHGeyJCVeb9P3Tav+BgQZWWm7Tu8cvJY3pllR4sD6L1iuwMOar06yVKxdKD08Vn8tc8QuPWo8H9jHBgBQ/xe/3mse4eCQ+GO3V2kY7uD8bghoRB8fMp8gKzsYgk2Tx7brTYF/jJ1b0+NzaOc9lYbgTQqrVvFdmDwDWTRM7I5XddlMQzHK1cCVEE507DMsNYKYTDOPkwSQiiscELIlYcgIC7Jbe2ITalxVdGU4rd52Jnwlb4CE3+EaKQJaHbQ/WcZGS0VNJB3eULxDMz2pnqdER2WW388zVNxQPJXUY1vlUqAx8=
  - secure: Dm1j8chLSQXKWGqkD+hc9RERVs6SDIatBQaO4fjNKWUi/402fBhbsyJax8Yz0+2TlbPIW0VmA/3K9FS8rG5GlRMT5cWVe1pUSlo7j/omHFwz1IxEqXQM2myqtiQ3jNm9tbueXKyqpJvT/qXkBw5UMCi3OT35yEjEEYMoB7QZTrtZat8A+1Sk3i3yxHd083xAizY4BVNHT2uKn2pfsQQnBKtH0vHU2yLng6JcJQYC2xfM4ibbStO7Din6zL6CatPUTCKUsyugD84AdieorhyrqShTtphrvmCQQy4xKHXGvnM1dGFZHhwTsIO03dFXn7y9G+u2wI5LVa6AUkFUhh5HItl1GtvEbGGhztkV1YZ2VGSSSgLzLCMmluvmLuGOPOF82q28VTO0/lNpwh+g8WuZoOx3w3e93fdyTxDWYJHIZPaohuAJd+nveMNz95+L9eaYPyygpgIeTilxxRBrAprahz+s3uk3LE0GLujruTzHUBLTn85HOdpP8jhX7BsaqbX/3gRygcuzbRBJZjYp1JmDkeduelBSNK5D124Jpi8vTJgBn09Ksd3tc7Y4gA3ZmoYnvBpL48nTRCdlGT8ufS1VdaqLurCQJv85i/qfo/QZYkWEcKjHwJ0CF087o79p5kKQLHLMWHwFO9tjUvdtnuC0o1/nsyRswOiFqlr3nkKsklI=
before_install:
- openssl aes-256-cbc -K $encrypted_8e63f1f6c3b0_key -iv $encrypted_8e63f1f6c3b0_iv
  -in travis/codesigning.asc.enc -out travis/codesigning.asc -d
- gpg --fast-import travis/codesigning.asc
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
deploy:
  provider: script
  script: "./gradlew publishToNexus --info --stacktrace && ./gradlew closeAndReleaseRepository --info --stacktrace"
  on:
    branch: master
notifications:
  slack:
    rooms:
      secure: OryM4rqFIYisgVyRYc4OP+vEPzbcUBbYkVMtQAyoQANEuGmH8SplXthmhyMggvD1s7KCqvZcHtcWs38D97Vkg7E/TNrxmnvrzZEKOLHdDu0CUQPvjLvs9CNdJFtlVJPJlpqEbzu0Yva76OjDnvioStmt9kF25BK6kNzWT3fhwmVvBKJU5rycZ7vhD/C+InJE9Nugynkkix/jW1F/fcAXgBTtIp1Ap7dzoiWAdR9IRkyuZXzkm9RejlhU1Yx9IffQwAXERpPLBTWYcljNjgZk8v4WRc9Nv9MVZXbrbOzl+hC8YvadqSLHBhURK/eHCeN/KGppp86RiKOGn3zaFGe+1u1yPogCk8rNXH0W0ng8Zmr8V9WyKCmouUFcDeYiHesOm+iBOb5R6Egwu3FG6Di+gVxwa0cqQKP2mLhN0AJPjWNTrXFAKVn+rthZzP82Z6Zd0GPYx85clvoI8beGHxBq1ROJBb1e8uft2+EZdjyt/F7fxEUUgARTmSX8XrS8VXQ3iIKURe/kM2P7Vc3dlH51H0u6efS6+BDnyTzF8ifzZKYl2UguhDRbxWEmStCCFeZQ7YK29minRUjPw6QN1NoeQ7yUS1OmiGsA6cLr41YGPAJmdnWD6Nr/aUR7crUqAAaWxg0S8UEeWlWx4uUhzeLFWi+iUyDsIX4NEWRemJ9ODRY=
  on_success: change
  on_failure: always
  on_pull_requests: false